---
title: 如何使用 getSignaturesForAddress
sidebarTitle: getSignaturesForAddress
description: 了解 getSignaturesForAddress 的使用案例、代码示例、请求参数、响应结构和提示。
---

[`getSignaturesForAddress`](https://www.helius.dev/docs/api-reference/rpc/http/getsignaturesforaddress) RPC 方法允许您检索涉及特定账户地址的已确认交易签名列表。这对于获取账户的交易历史非常有用。签名按时间倒序返回（最新的在前）。

<Tip>
**尝试 `getTransactionsForAddress`**：我们新的 [`getTransactionsForAddress`](https://www.helius.dev/docs/rpc/gettransactionsforaddress) 方法将 `getSignaturesForAddress` 和 `getTransaction` 合并为一个调用，并包含强大的新功能，包括反向搜索、基于时间的过滤和分页。
</Tip>

## 常见用例

* **账户交易历史：** 显示用户钱包的过去交易。对于更高级的交易历史解析，考虑使用 Helius 的 [增强交易 API](https://www.helius.dev/docs/enhanced-transactions)。
* **活动审计：** 审查与特定智能合约或账户相关的所有交易。
* **特定交易查找：** 如果只知道相关地址，通过遍历账户历史查找特定交易。
* **数据索引：** 构建本地化的交易索引以加快查询和分析。

## 请求参数

1.  **`address`** (`string`): （必需）要检索交易签名的账户的 base-58 编码公钥。
2.  **`options`** (`object`, 可选): 一个可选的配置对象，包含以下字段：
    *   **`limit`** (`number`, 可选): 要返回的最大签名数。默认是 1000，最大允许值是 1000。
    *   **`before`** (`string`, 可选): 一个 base-58 编码的交易签名。如果提供，查询将从此签名之前开始搜索交易。
    *   **`until`** (`string`, 可选): 一个 base-58 编码的交易签名。如果提供，查询将搜索直到达到此签名（不包括）。
    *   **`commitment`** (`string`, 可选): 指定用于查询的[承诺级别](https://www.helius.dev/blog/solana-commitment-levels)。支持的值是 `finalized` 或 `confirmed`。不支持 `processed` 承诺。如果省略，将使用 RPC 节点的默认承诺（通常是 `finalized`）。
    *   **`minContextSlot`** (`number`, 可选): 请求可以评估的最小槽位。这不是对历史交易的过滤，而是为节点的上下文设置最小槽位。

<Warning>
**不支持批处理**

此归档方法不支持批处理。仅进行单独请求。
</Warning>

## 响应结构

JSON-RPC 响应的 `result` 字段是一个签名信息对象的数组。每个对象具有以下结构：

*   **`signature`** (`string`): 基于58编码的交易签名。
*   **`slot`** (`u64`): 处理交易的槽位。
*   **`err`** (`object` | `null`): 如果交易失败，则为错误对象；如果成功，则为 `null`。
*   **`memo`** (`string` | `null`): 交易相关的备忘录（如果有）。
*   **`blockTime`** (`i64` | `null`): 包含交易的区块的估计生产时间，以 Unix 时间戳表示（自纪元以来的秒数）。如果不可用，则为 `null`。
*   **`confirmationStatus`** (`string` | `null`): 交易的确认状态（例如，`processed`，`confirmed`，`finalized`）。如果不可用（例如，对于较旧的 Helius 响应），则为 `null`。

## 示例

### 1. 获取地址的最新签名

此示例获取给定地址的最近（最多 1000 个）交易签名。

<CodeGroup>

```bash cURL
# Replace <api-key> with your Helius API key
# Replace SYSTEM_PROGRAM_ID with the address you want to query
curl https://mainnet.helius-rpc.com/?api-key=<api-key> -X POST -H "Content-Type: application/json" -d \
  '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "getSignaturesForAddress",
    "params": [
      "11111111111111111111111111111111" 
    ]
  }'
```

```javascript JavaScript (using @solana/web3.js)
// Replace <api-key> with your Helius API key
const { Connection, PublicKey } = require('@solana/web3.js');

async function getLatestSignatures() {
  const connection = new Connection('https://mainnet.helius-rpc.com/?api-key=<api-key>');
  // Replace with the public key you want to query
  const address = new PublicKey('11111111111111111111111111111111'); 

  try {
    const signatures = await connection.getSignaturesForAddress(address);
    if (signatures && signatures.length > 0) {
      console.log(`Found ${signatures.length} signatures:`);
      signatures.forEach((sigInfo, index) => {
        console.log(`--- Signature ${index + 1} ---`);
        console.log(`  Signature: ${sigInfo.signature}`);
        console.log(`  Slot: ${sigInfo.slot}`);
        console.log(`  Block Time: ${sigInfo.blockTime ? new Date(sigInfo.blockTime * 1000).toLocaleString() : 'N/A'}`);
        console.log(`  Error: ${JSON.stringify(sigInfo.err)}`);
        console.log(`  Memo: ${sigInfo.memo || 'N/A'}`);
        console.log(`  Confirmation Status: ${sigInfo.confirmationStatus || 'N/A'}`);
      });
    } else {
      console.log('No signatures found for this address.');
    }
  } catch (error) {
    console.error('Error fetching signatures:', error);
  }
}

getLatestSignatures();
```

</CodeGroup>

### 2. 获取有限制的签名

此示例获取指定数量的地址的最近交易签名。

<CodeGroup>

```bash cURL
# Replace <api-key> with your Helius API key
# Replace TARGET_ACCOUNT_ADDRESS with the address you want to query
curl https://mainnet.helius-rpc.com/?api-key=<api-key> -X POST -H "Content-Type: application/json" -d \
  '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "getSignaturesForAddress",
    "params": [
      "TARGET_ACCOUNT_ADDRESS",
      {
        "limit": 5 
      }
    ]
  }'
```

```javascript JavaScript (using @solana/web3.js)
// Replace <api-key> with your Helius API key
const { Connection, PublicKey } = require('@solana/web3.js');

async function getLimitedSignatures() {
  const connection = new Connection('https://mainnet.helius-rpc.com/?api-key=<api-key>');
  // Replace with the public key you want to query
  const address = new PublicKey('Vote111111111111111111111111111111111111111'); 
  const limit = 5;

  try {
    const signatures = await connection.getSignaturesForAddress(address, { limit });
    console.log(`Fetched up to ${limit} signatures:`);
    signatures.forEach((sigInfo, index) => {
      console.log(`${index + 1}. Signature: ${sigInfo.signature}, Slot: ${sigInfo.slot}`);
    });
  } catch (error) {
    console.error(`Error fetching limited signatures for ${address.toBase58()}:`, error);
  }
}

getLimitedSignatures();
```

</CodeGroup>

### 3. 分页获取交易历史

此示例演示如何使用 `before` 参数批量获取交易历史。

<CodeGroup>

```bash cURL
# Initial request (get the latest 2)
# Replace <api-key> with your Helius API key
# Replace TARGET_ACCOUNT_ADDRESS with the address you want to query
curl https://mainnet.helius-rpc.com/?api-key=<api-key> -X POST -H "Content-Type: application/json" -d \
  '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "getSignaturesForAddress",
    "params": [
      "TARGET_ACCOUNT_ADDRESS",
      { "limit": 2 }
    ]
  }'

# Suppose the last signature from the above response was LAST_SIGNATURE_FROM_PREVIOUS_BATCH
# Fetch the next 2 transactions before that one
curl https://mainnet.helius-rpc.com/?api-key=<api-key> -X POST -H "Content-Type: application/json" -d \
  '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "getSignaturesForAddress",
    "params": [
      "TARGET_ACCOUNT_ADDRESS",
      { 
        "limit": 2,
        "before": "LAST_SIGNATURE_FROM_PREVIOUS_BATCH" 
      }
    ]
  }'
```

```javascript JavaScript (using @solana/web3.js)
// Replace <api-key> with your Helius API key
const { Connection, PublicKey } = require('@solana/web3.js');

async function paginateSignatures() {
  const connection = new Connection('https://mainnet.helius-rpc.com/?api-key=<api-key>');
  // Replace with the public key you want to query - e.g. a known active address
  const address = new PublicKey('Vote111111111111111111111111111111111111111'); 
  const batchSize = 2;
  let lastSignature = null;
  let allSignatures = [];
  const maxPages = 3; // Limit how many pages we fetch for this example

  try {
    for (let i = 0; i < maxPages; i++) {
      console.log(`Fetching page ${i + 1}...`);
      const options = { limit: batchSize };
      if (lastSignature) {
        options.before = lastSignature;
      }

      const signatures = await connection.getSignaturesForAddress(address, options);
      
      if (signatures.length === 0) {
        console.log('No more signatures found.');
        break;
      }

      signatures.forEach(sigInfo => {
        allSignatures.push(sigInfo.signature);
        console.log(`  Found: ${sigInfo.signature} in slot ${sigInfo.slot}`);
      });
      
      lastSignature = signatures[signatures.length - 1]?.signature;

      if (signatures.length < batchSize || !lastSignature) {
         console.log('Fetched all available signatures or reached end of page.');
         break;
      }
      // Optional: Add a small delay if making many sequential requests
      // await new Promise(resolve => setTimeout(resolve, 200)); 
    }
    console.log(`
Total signatures fetched (${allSignatures.length}):`);
    allSignatures.forEach((sig, idx) => console.log(`${idx + 1}. ${sig}`));

  } catch (error) {
    console.error('Error paginating signatures:', error);
  }
}

paginateSignatures();
```

</CodeGroup>

## 开发者提示

*   **分页：** 要获取活跃账户的完整交易历史，您可能需要进行多次请求，使用上一个批次中收到的最后一个签名和 `limit` 参数。
*   **速率限制：** 在获取大量交易历史时，请注意 RPC 节点的速率限制。
*   **顺序：** 签名总是从最新到最旧返回。
*   **`limit` 参数：** `limit` 参数可以在 1 到 1000 之间。如果未指定，默认为 1000。
*   **`until` 参数：** 此参数可用于在达到已知的较旧签名时停止获取签名，这在您只需要某个点之前的交易时很有用。
*   **`minContextSlot`：** 此参数不筛选历史交易。它指定 RPC 节点在评估请求时应使用的最小槽位。如果节点的状态早于此槽位，可能会返回错误。
*   **交易详情：** 此方法仅返回签名和基本信息。要获取完整的交易详情，您需要对每个签名使用 `getTransaction` 方法。

通过使用`getSignaturesForAddress`及其分页选项，您可以有效地检索和管理任何Solana地址的交易历史。
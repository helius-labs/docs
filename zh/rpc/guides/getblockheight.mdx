---
title: 如何使用 getBlockHeight
sidebarTitle: getBlockHeight
description: 了解 getBlockHeight 的使用案例、代码示例、请求参数、响应结构和提示。
---

[`getBlockHeight`](https://www.helius.dev/docs/api-reference/rpc/http/getblockheight) RPC 方法是查询 Solana 节点当前区块高度的简单方式。区块高度表示自创世区块（插槽 0）以来已处理的区块数量。

此方法对于快速了解链的进展情况或在特定承诺级别引用最新区块高度非常有用。

## 常见用例

*   **监控链进展：** 定期调用此方法以查看链的推进情况。
*   **获取链长度快照：** 确定在某个时间点（基于承诺）处理的区块总数。
*   **与其他数据交叉引用：** 在分析其他链上数据或事件时，使用区块高度作为参考点。

## 参数

`getBlockHeight` 可以选择性地将配置对象作为第一个参数（或不带参数调用以使用默认值）：

1.  `config`（对象，可选）：具有以下字段的配置对象：
    *   `commitment`（字符串，可选）：指定用于查询的承诺级别。默认为 `finalized`。
        *   `finalized`：节点将查询由集群的绝大多数确认已达到最大锁定的最新区块。
        *   `confirmed`：节点将查询集群绝大多数已投票的最新区块。
        *   `processed`：节点将查询其最新的区块。请注意，该区块可能不完整。
    *   `minContextSlot`（数字，可选）：请求可以评估的最小插槽。这确保返回的区块高度来自于等于或大于 `minContextSlot` 的插槽。

如果未提供参数，该方法通常默认为 `finalized` 承诺。

## 开发者提示

*   **承诺级别很重要**：返回的区块高度可能会根据指定的 `commitment` 级别而有所不同。`finalized` 提供最稳定的高度，而 `processed` 可能提供更当前但可能是暂时的高度。
*   **`minContextSlot` 保持一致性**：如果需要确保区块高度是从至少与您正在跟踪的特定插槽一样新的状态查询的，请使用 `minContextSlot`。
*   **不是插槽号**：请记住，区块高度不同于插槽号。插槽是一个时间段，并不是每个插槽都会产生区块（这些称为跳过插槽）。区块高度是实际产生的区块数量。
*   **基本链健康检查**：虽然简单，但 `getBlockHeight` 可以作为您的应用程序或监控系统的基本链健康或同步检查的一部分。

## 响应

JSON-RPC 响应的 `result` 字段将是一个单一的数字：

*   `blockHeight` (number): 根据指定的承诺级别，节点的当前区块高度 (u64)。

**示例响应JSON：**

```json
{
  "jsonrpc": "2.0",
  "result": 275123456, // Example block height
  "id": 1
}
```

此值表示从创世区块（槽位0）到链的当前头部，查询节点所看到的最长链上的区块数量。

## 示例：获取当前区块高度

让我们从Helius Devnet RPC获取当前区块高度。

**注意：** 在下面的示例中，将 `YOUR_API_KEY` 替换为您实际的 Helius API 密钥。

<CodeGroup>

```bash curl
curl https://mainnet.helius-rpc.com/?api-key=YOUR_API_KEY -X POST -H "Content-Type: application/json" -d \
'{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getBlockHeight",
  "params": [] 
}'
```

```javascript JavaScript (using @solana/web3.js)
const { Connection } = require('@solana/web3.js');

async function getCurrentBlockHeight() {
  const rpcUrl = 'https://mainnet.helius-rpc.com/?api-key=YOUR_API_KEY'; // Replace YOUR_API_KEY
  const connection = new Connection(rpcUrl, 'confirmed');

  try {
    const blockHeight = await connection.getBlockHeight();
    console.log(`Current Block Height: ${blockHeight}`);

  } catch (error) {
    console.error('Error fetching block height:', error);
  }
}

getCurrentBlockHeight();
```

```typescript Kit
import { createSolanaRpc } from "@solana/kit";

const rpc_url = "https://mainnet.helius-rpc.com/?api-key=YOUR_API_KEY";
const rpc = createSolanaRpc(rpc_url);

let blockHeight = await rpc.getBlockHeight().send();

console.log("block height:", blockHeight);
```

```rust Rust
use anyhow::Result;
use solana_client::nonblocking::rpc_client::RpcClient;
use solana_sdk::commitment_config::CommitmentConfig;

#[tokio::main]
async fn main() -> Result<()> {
    let client = RpcClient::new_with_commitment(
        String::from("https://mainnet.helius-rpc.com/?api-key=YOUR_API_KEY"),
        CommitmentConfig::confirmed(),
    );

    let block_height = client.get_block_height().await?;

    println!("Block height: {:#?}", block_height);

    Ok(())
}
```

</CodeGroup>
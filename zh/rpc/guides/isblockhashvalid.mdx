---
title: 如何使用 isBlockhashValid
sidebarTitle: isBlockhashValid
description: 了解 isBlockhashValid 的使用案例、代码示例、请求参数、响应结构和提示。
---

[RPC 方法](https://www.helius.dev/docs/api-reference/rpc/http/isblockhashvalid)用于检查先前获取的区块哈希是否仍被网络视为有效。区块哈希的有效期有限（大约 2 分钟或 150 个区块），之后引用它们的交易将被拒绝。

此方法对于在提交交易前保留 blockhash 一段时间的应用程序至关重要，以确保交易不会因 blockhash 过期而失败。

**版本说明：** 此方法在 v1.9 及更新版本中可用。对于运行 v1.8 或更早版本的节点，您应该使用它，除了费用信息外，还隐含地指示区块哈希的有效性（如果区块哈希过旧，将会出错）。

## 常见用例

*   **交易重试：** 在重试失败的交易之前，检查其原始 blockhash 是否仍然有效。如果无效，则必须获取新的 blockhash。
*   **延迟交易签名：** 如果交易已准备好但稍后才签名和提交，请在提交前验证 blockhash 的有效性。
*   **乐观交易处理：** 确定如果立即发送交易，blockhash 是否可能被网络接受。

## 请求参数

1.  **（字符串，必需）：** 要检查的区块哈希，作为 base-58 编码的字符串。
2.  **（对象，可选）：** 可选的配置对象，可以包括：
    *   **（字符串，可选）：** 指定查询的[承诺级别](https://www.helius.dev/blog/solana-commitment-levels)（例如，）。如果省略，则使用节点的默认承诺。
    *   **（u64，可选）：** 请求可以评估的最小槽。这确保 RPC 节点不会响应来自比更旧的槽的状态。

## 响应结构

JSON-RPC 响应中的字段是一个对象，包含：

*   **（对象）：** 包含：
    *   **（u64）：** RPC 节点评估区块哈希有效性的槽。
*   **（布尔值）：** 如果区块哈希仍然有效，否则。

**示例响应（有效的区块哈希）：**



**示例响应（无效/过期的区块哈希）：**



## 代码示例

<CodeGroup>





</CodeGroup>

## 开发者提示

*   **区块哈希过期：** 区块哈希仅在有限时间内有效（大约150个槽，或大约1-2分钟）。如果不确定或已经过了很长时间，请始终获取新的区块哈希。
*   **`minContextSlot` 用法：** 使用 `minContextSlot` 来防止查询过时的RPC节点，这些节点可能会给出一个实际上对集群其余部分来说太旧的区块哈希的过时“有效”响应。
*   **旧节点的替代方案：** 对于运行Solana 1.9之前版本的节点，使用 `getFeeCalculatorForBlockhash("<YOUR_BLOCKHASH>")`。如果此方法成功返回，则区块哈希有效。如果出现错误（通常是因为找不到区块哈希或太旧），则区块哈希无效。
*   **网络确认：** 即使 `isBlockhashValid` 返回 `true`，交易只有在提交后达到网络上的所需承诺级别时才会最终确定。

本指南提供了在构建Solana应用程序时有效使用 `isBlockhashValid` RPC方法的必要细节。
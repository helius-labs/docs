---
title: ä½¿ç”¨ Yellowstone gRPC è¿›è¡Œè´¦æˆ·ç›‘æ§
sidebarTitle: è´¦æˆ·ç›‘æ§
description: é€šè¿‡é«˜çº§è¿‡æ»¤é€‰é¡¹ã€æ•°æ®åˆ‡ç‰‡å’Œå®ç”¨çš„å®ç°æ¨¡å¼ï¼Œå®æ—¶ç›‘æ§ Solana è´¦æˆ·çš„å˜åŒ–ã€‚
---

## æ¦‚è¿°

è´¦æˆ·ç›‘æ§è®©æ‚¨å¯ä»¥å®æ—¶è·Ÿè¸ª Solana ä¸Šçš„ä½™é¢å˜åŒ–ã€æ•°æ®ä¿®æ”¹ã€æ‰€æœ‰æƒè½¬ç§»ä»¥åŠè´¦æˆ·åˆ›å»º/åˆ é™¤äº‹ä»¶ã€‚æœ¬æŒ‡å—æ¶µç›–äº†ä¸åŒç”¨ä¾‹çš„è¿‡æ»¤ç­–ç•¥å’Œå®ç°æ¨¡å¼ã€‚

<Info>
**å…ˆå†³æ¡ä»¶ï¼š** æœ¬æŒ‡å—å‡è®¾æ‚¨å·²å®Œæˆ [Yellowstone gRPC å¿«é€Ÿå…¥é—¨](/zh/grpc/quickstart) å¹¶å·²è®¾ç½®å¥½å·¥ä½œæµã€‚
</Info>

## è´¦æˆ·è¿‡æ»¤é€‰é¡¹

<Tabs>
  <Tab title="ç‰¹å®šè´¦æˆ·">
    **é€šè¿‡å…¬é’¥ç›‘æ§å•ä¸ªè´¦æˆ·**
    
    å½“æ‚¨ç¡®åˆ‡çŸ¥é“è¦ç›‘æ§å“ªäº›è´¦æˆ·æ—¶ä½¿ç”¨ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      accounts: {
        accountSubscribe: {
          account: [
            "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v", // USDC mint
            "So11111111111111111111111111111111111111112"   // Wrapped SOL
          ],
          owner: [],
          filters: []
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Note>
    **æœ€ä½³ç”¨é€”ï¼š** ç›‘æ§ç‰¹å®šä»£å¸é“¸é€ ã€å·²çŸ¥é’±åŒ…æˆ–å…³é”®ç¨‹åºè´¦æˆ·
    </Note>
  </Tab>
  
  <Tab title="æŒ‰æ‰€æœ‰è€…">
    **ç›‘æ§ç‰¹å®šç¨‹åºæ‹¥æœ‰çš„æ‰€æœ‰è´¦æˆ·**
    
    è·Ÿè¸ªç”±æŸä¸ªç¨‹åºæ‹¥æœ‰çš„æ‰€æœ‰è´¦æˆ·ï¼ˆä¾‹å¦‚ï¼Œç‰¹å®šé“¸é€ çš„æ‰€æœ‰ä»£å¸è´¦æˆ·ï¼‰ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      accounts: {
        accountSubscribe: {
          account: [],
          owner: [
            "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA", // Token Program
            "11111111111111111111111111111111"              // System Program
          ],
          filters: []
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Warning>
    **é«˜æ•°æ®é‡ï¼š** æ‰€æœ‰è€…è¿‡æ»¤å™¨å¯èƒ½ä¼šç”Ÿæˆå¤§é‡æ•°æ®ã€‚ä½¿ç”¨å…¶ä»–è¿‡æ»¤å™¨æ¥ç¼©å°ç»“æœèŒƒå›´ã€‚
    </Warning>
  </Tab>
  
  <Tab title="é«˜çº§è¿‡æ»¤å™¨">
    **ç»“åˆæ•°æ®å¤§å°å’Œå†…å­˜æ¯”è¾ƒè¿‡æ»¤å™¨**
    
    é€šè¿‡æ•°æ®ç»“æ„å’Œå†…å®¹è¿‡æ»¤è´¦æˆ·ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      accounts: {
        accountSubscribe: {
          account: [],
          owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
          filters: [
            // Only token accounts (165 bytes)
            { dataSize: 165 },
            // Only USDC token accounts (mint at offset 0)
            { 
              memcmp: { 
                offset: 0, 
                bytes: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v" 
              } 
            }
          ]
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Tip>
    **é«˜æ•ˆè¿‡æ»¤ï¼š** ç»“åˆå¤§å°å’Œå†…å®¹è¿‡æ»¤å™¨ä»¥æœ€å°åŒ–ä¸å¿…è¦çš„æ•°æ®
    </Tip>
  </Tab>
</Tabs>

## æ•°æ®åˆ‡ç‰‡

é€šè¿‡è¯·æ±‚è´¦æˆ·æ•°æ®çš„ç‰¹å®šå­—èŠ‚èŒƒå›´æ¥ä¼˜åŒ–å¸¦å®½ï¼š

<CodeGroup>

```typescript "Token Account Balance Only"
// Only get the balance portion of token accounts (bytes 64-72)
const subscribeRequest: SubscribeRequest = {
  accounts: {
    accountSubscribe: {
      owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
      filters: [{ dataSize: 165 }]
    }
  },
  accountsDataSlice: [
    { offset: 64, length: 8 } // Token balance (u64)
  ],
  commitment: CommitmentLevel.CONFIRMED
};
```

```typescript "Multiple Data Ranges"
// Get mint (0-32) and balance (64-72) from token accounts
const subscribeRequest: SubscribeRequest = {
  accounts: {
    accountSubscribe: {
      owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
      filters: [{ dataSize: 165 }]
    }
  },
  accountsDataSlice: [
    { offset: 0, length: 32 },  // Mint public key
    { offset: 64, length: 8 }   // Balance
  ],
  commitment: CommitmentLevel.CONFIRMED
};
```

</CodeGroup>

## å®ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç›‘æ§å¤§é¢ä»£å¸æŒæœ‰è€…

è·Ÿè¸ªå…·æœ‰å¤§é‡ä½™é¢çš„ USDC è´¦æˆ·ï¼š

```typescript
import { StreamManager } from './stream-manager'; // From quickstart guide

async function monitorLargeUSDCHolders() {
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleLargeHolderUpdate
  );

  const subscribeRequest: SubscribeRequest = {
    accounts: {
      accountSubscribe: {
        owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
        filters: [
          { dataSize: 165 }, // Token account size
          { 
            memcmp: { 
              offset: 0, 
              bytes: "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v" // USDC mint
            } 
          }
        ]
      }
    },
    accountsDataSlice: [
      { offset: 32, length: 32 }, // Owner
      { offset: 64, length: 8 }   // Balance
    ],
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleLargeHolderUpdate(data: any): void {
  if (data.account) {
    const account = data.account.account;
    
    // Parse token account data
    if (account.data && account.data.length >= 8) {
      const balanceBuffer = Buffer.from(account.data.slice(64, 72), 'base64');
      const balance = balanceBuffer.readBigUInt64LE();
      const balanceInUSDC = Number(balance) / 1e6; // USDC has 6 decimals
      
      // Only log accounts with > 100,000 USDC
      if (balanceInUSDC > 100000) {
        console.log(`ğŸ‹ Large USDC Holder Update:`);
        console.log(`  Account: ${account.pubkey}`);
        console.log(`  Balance: ${balanceInUSDC.toLocaleString()} USDC`);
        console.log(`  Slot: ${data.account.slot}`);
      }
    }
  }
}
```

### ç¤ºä¾‹ 2ï¼šè·Ÿè¸ªç¨‹åºè´¦æˆ·å˜åŒ–

ç›‘æ§ç”±ç‰¹å®šç¨‹åºæ‹¥æœ‰çš„æ‰€æœ‰è´¦æˆ·ï¼š

```typescript
async function monitorProgramAccounts() {
  const PROGRAM_ID = "YourProgramId"; // Replace with actual program ID
  
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleProgramAccountUpdate
  );

  const subscribeRequest: SubscribeRequest = {
    accounts: {
      accountSubscribe: {
        owner: [PROGRAM_ID],
        filters: []
      }
    },
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleProgramAccountUpdate(data: any): void {
  if (data.account) {
    const account = data.account.account;
    console.log(`ğŸ“‹ Program Account Update:`);
    console.log(`  Account: ${account.pubkey}`);
    console.log(`  Owner: ${account.owner}`);
    console.log(`  Lamports: ${account.lamports}`);
    console.log(`  Data Length: ${account.data?.length || 0} bytes`);
    console.log(`  Executable: ${account.executable}`);
    console.log(`  Rent Epoch: ${account.rentEpoch}`);
  }
}
```

### ç¤ºä¾‹ 3ï¼šæ–°è´¦æˆ·åˆ›å»ºç›‘æ§

è·Ÿè¸ªæ–°è´¦æˆ·åˆ›å»ºçš„æ—¶é—´ï¼š

```typescript
async function monitorNewAccounts() {
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleNewAccountCreation
  );

  const subscribeRequest: SubscribeRequest = {
    accounts: {
      accountSubscribe: {
        owner: ["11111111111111111111111111111111"], // System Program
        filters: []
      }
    },
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleNewAccountCreation(data: any): void {
  if (data.account && data.account.account.lamports === 0) {
    // New account creation typically starts with 0 lamports
    const account = data.account.account;
    console.log(`ğŸ†• New Account Created:`);
    console.log(`  Account: ${account.pubkey}`);
    console.log(`  Owner: ${account.owner}`);
    console.log(`  Slot: ${data.account.slot}`);
  }
}
```

## è¿‡æ»¤é€»è¾‘å‚è€ƒ

äº†è§£è¿‡æ»¤å™¨å¦‚ä½•ç»„åˆï¼š

<Accordion title="è¿‡æ»¤å™¨ç»„åˆè§„åˆ™">
  **è´¦æˆ·çº§è¿‡æ»¤å™¨ï¼ˆANDé€»è¾‘ï¼‰ï¼š**
  - `account` AND `owner` AND `filters` å¿…é¡»å…¨éƒ¨åŒ¹é…ï¼ˆå¦‚æœæŒ‡å®šï¼‰
  
  **æ•°ç»„å†…ï¼ˆORé€»è¾‘ï¼‰ï¼š**
  - `account` æ•°ç»„ä¸­çš„ä»»ä½•è´¦æˆ·åŒ¹é…
  - `owner` æ•°ç»„ä¸­çš„ä»»ä½•æ‰€æœ‰è€…åŒ¹é…
  
  **è¿‡æ»¤å™¨æ•°ç»„å†…ï¼ˆANDé€»è¾‘ï¼‰ï¼š**
  - æ‰€æœ‰ dataSize å’Œ memcmp è¿‡æ»¤å™¨å¿…é¡»åŒ¹é…
  
  **ç¤ºä¾‹ï¼š**

  ```typescript
  {
    account: ["A", "B"],      // Match account A OR B
    owner: ["X", "Y"],        // AND owned by X OR Y  
    filters: [
      { dataSize: 100 },      // AND data size is 100
      { memcmp: {...} }       // AND memcmp matches
    ]
  }
  ```

</Accordion>

<Accordion title="å¸¸è§è¿‡æ»¤å™¨æ¨¡å¼">
  **ç‰¹å®šé“¸å¸çš„ä»£å¸è´¦æˆ·ï¼š**

  ```typescript
  {
    owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
    filters: [
      { dataSize: 165 },
      { memcmp: { offset: 0, bytes: "MINT_ADDRESS" } }
    ]
  }
  ```

  
  **å…·æœ‰æœ€ä½ä½™é¢çš„ SPL ä»£å¸è´¦æˆ·ï¼š**

  ```typescript
  {
    owner: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
    filters: [
      { dataSize: 165 },
      { memcmp: { offset: 64, bytes: "MINIMUM_BALANCE_BYTES" } }
    ]
  }
  ```

  
  **ç¨‹åºæ´¾ç”Ÿè´¦æˆ·ï¼š**

  ```typescript
  {
    owner: ["YOUR_PROGRAM_ID"],
    filters: [
      { dataSize: 200 }, // Your account size
      { memcmp: { offset: 8, bytes: "DISCRIMINATOR" } }
    ]
  }
  ```

</Accordion>

## æ€§èƒ½æ³¨æ„äº‹é¡¹

<CardGroup cols={2}>
  <Card title="å¸¦å®½ä¼˜åŒ–" icon="gauge-high">
    **ä½¿ç”¨æ•°æ®åˆ‡ç‰‡** ä»…è¯·æ±‚æ‰€éœ€å­—èŠ‚
    
    **åº”ç”¨ä¸¥æ ¼è¿‡æ»¤å™¨** ä»¥å‡å°‘ä¸å¿…è¦çš„æ›´æ–°
    
    **é€‰æ‹©é€‚å½“çš„æ‰¿è¯º** æ°´å¹³ä»¥é€‚åº”æ‚¨çš„ç”¨ä¾‹
  </Card>
  
  <Card title="è§„æ¨¡ç®¡ç†" icon="chart-area">
    **ä»ç‰¹å®šè´¦æˆ·å¼€å§‹** ç„¶åä½¿ç”¨æ‰€æœ‰è€…è¿‡æ»¤å™¨
    
    **ç›‘æ§è®¢é˜…é‡** å¹¶æ ¹æ®éœ€è¦è°ƒæ•´è¿‡æ»¤å™¨
    
    **å®ç°èƒŒå‹å¤„ç†** ä»¥åº”å¯¹é«˜æµé‡æµ
  </Card>
</CardGroup>

## é”™è¯¯å¤„ç†

å¸¸è§è´¦æˆ·ç›‘æ§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š

<Accordion title="è¿‡æ»¤å™¨è¿‡äºå®½æ³›">
  **é”™è¯¯ï¼š** æ¥æ”¶åˆ°è¿‡å¤šæ•°æ®æˆ–è¾¾åˆ°é€Ÿç‡é™åˆ¶
  
  **è§£å†³æ–¹æ¡ˆï¼š** æ·»åŠ æ›´å…·ä½“çš„è¿‡æ»¤å™¨ï¼š
  - ä½¿ç”¨ `dataSize` åŒ¹é…ç²¾ç¡®çš„è´¦æˆ·ç±»å‹
  - æ·»åŠ  `memcmp` è¿‡æ»¤å™¨ä»¥åŒ¹é…ç‰¹å®šæ•°æ®æ¨¡å¼
  - è€ƒè™‘ä½¿ç”¨ `accountsDataSlice` ä»¥å‡å°‘å¸¦å®½
</Accordion>

<Accordion title="æœªæ”¶åˆ°æ›´æ–°">
  **é”™è¯¯ï¼š** æµè¿æ¥æˆåŠŸä½†æ²¡æœ‰è´¦æˆ·æ›´æ–°å‡ºç°
  
  **è§£å†³æ–¹æ¡ˆï¼š** 
  - éªŒè¯è´¦æˆ·åœ°å€æ˜¯å¦æ­£ç¡®
  - æ£€æŸ¥è´¦æˆ·æ˜¯å¦ç¡®å®é¢‘ç¹æ›´æ”¹
  - å°è¯•ä½¿ç”¨ `PROCESSED` æ‰¿è¯ºä»¥è·å–æ›´é¢‘ç¹çš„æ›´æ–°
  - å…ˆæµ‹è¯•ä¸€ä¸ªå·²çŸ¥æ´»è·ƒçš„è´¦æˆ·
</Accordion>

## ä¸‹ä¸€æ­¥

<CardGroup cols={2}>
  <Card title="Transaction Monitoring" icon="receipt" href="/zh/grpc/transaction-monitoring">
    å­¦ä¹ å¦‚ä½•å°†è´¦æˆ·å˜åŠ¨ä¸äº¤æ˜“æ•°æ®å…³è”
  </Card>
  <Card title="Advanced Patterns" icon="code" href="/zh/grpc/stream-pump-amm-data">
    çœŸå®æ¡ˆä¾‹ï¼šç›‘æ§ DeFi åè®®
  </Card>
</CardGroup>

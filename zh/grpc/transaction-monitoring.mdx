---
title: ä½¿ç”¨ Yellowstone gRPC è¿›è¡Œäº¤æ˜“ç›‘æ§
sidebarTitle: äº¤æ˜“ç›‘æ§
description: é€šè¿‡ç¨‹åºè¿‡æ»¤ã€æ‰§è¡Œç»†èŠ‚å’Œä»£å¸ä½™é¢å˜åŒ–è·Ÿè¸ªï¼Œå®æ—¶æµå¼ä¼ è¾“ Solana äº¤æ˜“ã€‚
---

## æ¦‚è¿°

äº¤æ˜“ç›‘æ§ä½¿æ‚¨èƒ½å¤Ÿå®æ—¶è·Ÿè¸ª Solana ä¸Šçš„äº¤æ˜“æ‰§è¡Œã€æˆåŠŸ/å¤±è´¥çŠ¶æ€ã€ç¨‹åºäº¤äº’å’Œä»£å¸ä½™é¢å˜åŒ–ã€‚æœ¬æŒ‡å—æ¶µç›–äº†ä¸åŒäº¤æ˜“ç›‘æ§ç”¨ä¾‹çš„è¿‡æ»¤ç­–ç•¥å’Œå®é™…å®ç°ã€‚

<Info>
**å…ˆå†³æ¡ä»¶ï¼š** æœ¬æŒ‡å—å‡è®¾æ‚¨å·²å®Œæˆ [Yellowstone gRPC å¿«é€Ÿå…¥é—¨](/zh/grpc/quickstart) å¹¶å·²è®¾ç½®å¥½å·¥ä½œæµã€‚
</Info>

## äº¤æ˜“è¿‡æ»¤é€‰é¡¹

<Tabs>
  <Tab title="ç¨‹åºè¿‡æ»¤">
    **ç›‘æ§æ¶‰åŠç‰¹å®šç¨‹åºçš„äº¤æ˜“**
    
    è·Ÿè¸ªæ‰€æœ‰ä¸æ‚¨çš„ç¨‹åºäº¤äº’çš„äº¤æ˜“ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      transactions: {
        client: {
          accountInclude: [
            "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA", // Token Program
            "11111111111111111111111111111111",              // System Program
            "675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"  // Your program
          ],
          accountExclude: [],
          accountRequired: [],
          vote: false,
          failed: false
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Note>
    **æœ€ä½³ç”¨é€”ï¼š** ç¨‹åºç‰¹å®šç›‘æ§ã€DeFi åè®®è·Ÿè¸ªã€æ™ºèƒ½åˆçº¦äº¤äº’
    </Note>
  </Tab>
  
  <Tab title="ç‰¹å®šè´¦æˆ·">
    **ç›‘æ§å½±å“ç‰¹å®šè´¦æˆ·çš„äº¤æ˜“**
    
    è·Ÿè¸ªä¿®æ”¹ç‰¹å®šè´¦æˆ·çš„äº¤æ˜“ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      transactions: {
        client: {
          accountInclude: [
            "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v", // USDC mint
            "YourWalletAddress"                                // Your wallet
          ],
          vote: false,
          failed: true // Include failures to track errors
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Tip>
    **ç”¨ä¾‹ï¼š** é’±åŒ…ç›‘æ§ã€ä»£å¸é“¸é€ è·Ÿè¸ªã€ç‰¹å®šè´¦æˆ·æ´»åŠ¨
    </Tip>
  </Tab>
  
  <Tab title="é«˜çº§è¿‡æ»¤">
    **ç»“åˆå¤šä¸ªè¿‡æ»¤æ¡ä»¶**
    
    ä½¿ç”¨å¿…éœ€è´¦æˆ·å’Œæ’é™¤é¡¹è¿›è¡Œç²¾ç¡®è¿‡æ»¤ï¼š
    

    ```typescript
    const subscribeRequest: SubscribeRequest = {
      transactions: {
        client: {
          accountInclude: ["TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"],
          accountRequired: ["YourProgramId"], // Must include this program
          accountExclude: ["VoteProgram"],     // Exclude vote-related txs
          vote: false,
          failed: false
        }
      },
      commitment: CommitmentLevel.CONFIRMED
    };
    ```

    
    <Warning>
    **è¿‡æ»¤é€»è¾‘ï¼š** accountInclude (æˆ–) AND accountRequired (ä¸) AND NOT accountExclude
    </Warning>
  </Tab>
</Tabs>

## å®ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç›‘æ§ DEX äº¤æ˜“

è·Ÿè¸ªæ‰€æœ‰æ¶‰åŠæµè¡Œ DEX ç¨‹åºçš„äº¤æ˜“ï¼š

```typescript
import { StreamManager } from './stream-manager'; // From quickstart guide

async function monitorDEXTransactions() {
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleDEXTransaction
  );

  const subscribeRequest: SubscribeRequest = {
    transactions: {
      client: {
        accountInclude: [
          "9WzDXwBbmkg8ZTbNMqUxvQRAyrZzDsGYdLVL9zYtAWWM", // Raydium V4
          "675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8", // Raydium V5
          "CAMMCzo5YL8w4VFF8KVHrK22GGUQpMpTFb6xRmpLFGNnSm", // Raydium CLMM
          "JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4"   // Jupiter
        ],
        vote: false,
        failed: false
      }
    },
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleDEXTransaction(data: any): void {
  if (data.transaction?.transaction) {
    const tx = data.transaction.transaction;
    console.log(`\nğŸ”„ DEX Transaction:`);
    console.log(`  Signature: ${tx.signature}`);
    console.log(`  Slot: ${data.transaction.slot}`);
    console.log(`  Status: ${tx.meta?.err ? 'Failed' : 'Success'}`);
    console.log(`  Fee: ${tx.meta?.fee || 0} lamports`);
    console.log(`  Compute Units: ${tx.meta?.computeUnitsConsumed || 0}`);
    
    // Show token balance changes
    if (tx.meta?.preTokenBalances?.length > 0) {
      console.log(`  Token Balance Changes:`);
      tx.meta.preTokenBalances.forEach((preBalance: any, index: number) => {
        const postBalance = tx.meta.postTokenBalances[index];
        if (preBalance && postBalance) {
          const change = postBalance.uiTokenAmount.uiAmount - preBalance.uiTokenAmount.uiAmount;
          if (change !== 0) {
            console.log(`    ${preBalance.mint}: ${change > 0 ? '+' : ''}${change}`);
          }
        }
      });
    }
  }
}
```

### ç¤ºä¾‹ 2ï¼šç›‘æ§å¤±è´¥çš„äº¤æ˜“

è·Ÿè¸ªå¤±è´¥çš„äº¤æ˜“ä»¥è¯†åˆ«é—®é¢˜ï¼š

```typescript
async function monitorFailedTransactions() {
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleFailedTransaction
  );

  const subscribeRequest: SubscribeRequest = {
    transactions: {
      client: {
        accountInclude: ["YourProgramId"], // Your program
        vote: false,
        failed: true // Only failed transactions
      }
    },
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleFailedTransaction(data: any): void {
  if (data.transaction?.transaction?.meta?.err) {
    const tx = data.transaction.transaction;
    console.log(`\nâŒ Failed Transaction:`);
    console.log(`  Signature: ${tx.signature}`);
    console.log(`  Slot: ${data.transaction.slot}`);
    console.log(`  Error: ${JSON.stringify(tx.meta.err)}`);
    console.log(`  Fee: ${tx.meta.fee} lamports`);
    console.log(`  Compute Units: ${tx.meta.computeUnitsConsumed || 0}`);
    
    // Log instruction details for debugging
    if (tx.transaction?.message?.instructions) {
      console.log(`  Instructions:`);
      tx.transaction.message.instructions.forEach((inst: any, i: number) => {
        console.log(`    ${i}: Program ${inst.programIdIndex}, Data: ${inst.data}`);
      });
    }
  }
}
```

### ç¤ºä¾‹ 3ï¼šç›‘æ§é«˜ä»·å€¼äº¤æ˜“

è·Ÿè¸ªå…·æœ‰æ˜¾è‘— SOL è½¬ç§»çš„äº¤æ˜“ï¼š

```typescript
async function monitorHighValueTransactions() {
  const streamManager = new StreamManager(
    "your-grpc-endpoint",
    "your-api-key",
    handleHighValueTransaction
  );

  const subscribeRequest: SubscribeRequest = {
    transactions: {
      client: {
        accountInclude: ["11111111111111111111111111111111"], // System Program
        vote: false,
        failed: false
      }
    },
    commitment: CommitmentLevel.CONFIRMED
  };

  await streamManager.connect(subscribeRequest);
}

function handleHighValueTransaction(data: any): void {
  if (data.transaction?.transaction?.meta) {
    const tx = data.transaction.transaction;
    const preBalances = tx.meta.preBalances || [];
    const postBalances = tx.meta.postBalances || [];
    
    // Calculate largest balance change
    let maxChange = 0;
    preBalances.forEach((preBalance: number, index: number) => {
      const postBalance = postBalances[index] || 0;
      const change = Math.abs(postBalance - preBalance);
      maxChange = Math.max(maxChange, change);
    });
    
    // Only log transactions with > 10 SOL moved
    const changeInSOL = maxChange / 1e9;
    if (changeInSOL > 10) {
      console.log(`\nğŸ’° High-Value Transaction:`);
      console.log(`  Signature: ${tx.signature}`);
      console.log(`  Slot: ${data.transaction.slot}`);
      console.log(`  Max SOL Transfer: ${changeInSOL.toFixed(2)} SOL`);
      console.log(`  Fee: ${tx.meta.fee / 1e9} SOL`);
      console.log(`  Accounts: ${tx.transaction?.message?.accountKeys?.length || 0}`);
    }
  }
}
```

## äº¤æ˜“æ•°æ®ç»“æ„

ç†è§£äº¤æ˜“æ•°æ®ç»“æ„æœ‰åŠ©äºæå–ç›¸å…³ä¿¡æ¯ï¼š

<Accordion title="äº¤æ˜“æ¶ˆæ¯ç»“æ„">
  **æ ¸å¿ƒäº¤æ˜“æ•°æ®ï¼š**

  ```typescript
  {
    signature: string;
    isVote: boolean;
    transaction: {
      message: {
        accountKeys: string[];        // All accounts involved
        instructions: Instruction[];  // Program instructions
        recentBlockhash: string;     // Recent blockhash used
      };
      signatures: string[];          // Transaction signatures
    };
    meta: {
      err: any;                      // Error details if failed
      fee: number;                   // Transaction fee in lamports
      computeUnitsConsumed: number;  // Compute units used
      preBalances: number[];         // Account balances before
      postBalances: number[];        // Account balances after
      preTokenBalances: TokenBalance[];
      postTokenBalances: TokenBalance[];
      logMessages: string[];         // Program log messages
    };
  }
  ```

</Accordion>

<Accordion title="ä»£å¸ä½™é¢å˜åŒ–">
  **ä»£å¸ä½™é¢ç»“æ„ï¼š**

  ```typescript
  {
    accountIndex: number;
    mint: string;                   // Token mint address
    owner: string;                  // Account owner
    uiTokenAmount: {
      amount: string;               // Raw token amount
      decimals: number;             // Token decimals
      uiAmount: number;             // Human-readable amount
      uiAmountString: string;       // String representation
    };
  }
  ```

</Accordion>

<Accordion title="æŒ‡ä»¤è¯¦æƒ…">
  **ç¨‹åºæŒ‡ä»¤ç»“æ„ï¼š**

  ```typescript
  {
    programIdIndex: number;         // Index in accountKeys array
    accounts: number[];             // Account indices involved
    data: string;                   // Instruction data (base58)
  }
  ```

</Accordion>

## è¿‡æ»¤é€»è¾‘å‚è€ƒ

<CardGroup cols={2}>
  <Card title="åŒ…å«é€»è¾‘ (OR)" icon="plus">
    **accountInclude:** äº¤æ˜“å¿…é¡»æ¶‰åŠè¿™äº›è´¦æˆ·ä¸­çš„ä»»æ„ä¸€ä¸ª
    
    **ç¤ºä¾‹ï¼š** `["A", "B"]` åŒ¹é…æ¶‰åŠè´¦æˆ·Aæˆ–è´¦æˆ·Bçš„äº¤æ˜“
  </Card>
  
  <Card title="å¿…éœ€é€»è¾‘ (AND)" icon="check">
    **accountRequired:** äº¤æ˜“å¿…é¡»æ¶‰åŠæ‰€æœ‰è¿™äº›è´¦æˆ·
    
    **ç¤ºä¾‹ï¼š** `["A", "B"]` åŒ¹é…æ¶‰åŠè´¦æˆ·Aå’Œè´¦æˆ·Bçš„äº¤æ˜“
  </Card>
  
  <Card title="æ’é™¤é€»è¾‘ (NOT)" icon="minus">
    **accountExclude:** äº¤æ˜“ä¸å¾—æ¶‰åŠä»»ä½•è¿™äº›è´¦æˆ·
    
    **ç¤ºä¾‹ï¼š** `["A", "B"]` æ’é™¤æ¶‰åŠè´¦æˆ·Aæˆ–è´¦æˆ·Bçš„äº¤æ˜“
  </Card>
  
  <Card title="ç»„åˆé€»è¾‘" icon="code">
    **æœ€ç»ˆè¿‡æ»¤å™¨ï¼š** `(accountInclude OR empty) AND (accountRequired AND all) AND NOT (accountExclude OR any)`
  </Card>
</CardGroup>

## æ€§èƒ½è€ƒè™‘

<Tabs>
  <Tab title="æµé‡ç®¡ç†">
    **äº¤æ˜“æµå¯èƒ½æ˜¯é«˜æµé‡çš„**
    
    - ä»ç‰¹å®šç¨‹åºè¿‡æ»¤å™¨å¼€å§‹
    - é€‚å½“åœ°ä½¿ç”¨æ‰¿è¯ºçº§åˆ«
    - ç›‘æ§æ‚¨çš„å¤„ç†èƒ½åŠ›
    - å®æ–½èƒŒå‹å¤„ç†
    

    ```typescript
    // Rate limiting example
    let transactionCount = 0;
    const startTime = Date.now();
    
    function handleTransaction(data: any): void {
      transactionCount++;
      
      if (transactionCount % 100 === 0) {
        const elapsed = (Date.now() - startTime) / 1000;
        const rate = transactionCount / elapsed;
        console.log(`Processing ${rate.toFixed(1)} tx/sec`);
      }
      
      // Your transaction processing logic
    }
    ```

  </Tab>
  
  <Tab title="æ•°æ®å¤„ç†">
    **ä¼˜åŒ–æ•°æ®æå–**
    
    - å¼‚æ­¥å¤„ç†æ•°æ®
    - ä»…æå–æ‰€éœ€å­—æ®µ
    - ä½¿ç”¨é«˜æ•ˆçš„æ•°æ®ç»“æ„
    - è€ƒè™‘æ‰¹é‡æ›´æ–°
    

    ```typescript
    // Efficient data extraction
    function extractTransactionData(tx: any) {
      return {
        signature: tx.signature,
        slot: tx.slot,
        success: !tx.meta?.err,
        fee: tx.meta?.fee || 0,
        computeUnits: tx.meta?.computeUnitsConsumed || 0,
        tokenChanges: extractTokenChanges(tx.meta)
      };
    }
    ```

  </Tab>
</Tabs>

## é”™è¯¯å¤„ç†

å¸¸è§çš„äº¤æ˜“ç›‘æ§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆï¼š

<Accordion title="äº¤æ˜“è¿‡å¤š">
  **é”™è¯¯ï¼š** äº¤æ˜“é‡è¿‡å¤§
  
  **è§£å†³æ–¹æ¡ˆï¼š**
  - æ·»åŠ æ›´å…·ä½“çš„è¿‡æ»¤å™¨ï¼ˆaccountRequired, accountExcludeï¼‰
  - ä½¿ç”¨æ›´é«˜çš„æ‰¿è¯ºçº§åˆ«ä»¥å‡å°‘æµé‡
  - å®æ–½é‡‡æ ·æˆ–é€Ÿç‡é™åˆ¶
  - å¼‚æ­¥å¤„ç†äº¤æ˜“
</Accordion>

<Accordion title="äº¤æ˜“ç¼ºå¤±">
  **é”™è¯¯ï¼š** é¢„æœŸçš„äº¤æ˜“æœªå‡ºç°
  
  **è§£å†³æ–¹æ¡ˆï¼š**
  - éªŒè¯ç¨‹åºåœ°å€æ˜¯å¦æ­£ç¡®
  - æ£€æŸ¥äº¤æ˜“æ˜¯å¦å®é™…å‘ç”Ÿ
  - å°è¯•ä½¿ç”¨PROCESSEDæ‰¿è¯ºä»¥è·å¾—æ›´å¿«çš„æ›´æ–°
  - ç¡®ä¿è¿‡æ»¤å™¨ä¸è¿‡äºä¸¥æ ¼
</Accordion>

<Accordion title="è§£æé”™è¯¯">
  **é”™è¯¯ï¼š** æ— æ³•è§£æäº¤æ˜“æ•°æ®
  
  **è§£å†³æ–¹æ¡ˆï¼š**
  - ä¼˜é›…åœ°å¤„ç†ç¼ºå¤±å­—æ®µ
  - åœ¨å¤„ç†ä¹‹å‰éªŒè¯æ•°æ®ç»“æ„
  - è®°å½•æœ‰é—®é¢˜çš„äº¤æ˜“ä»¥ä¾¿è°ƒè¯•
  - åœ¨è§£æé€»è¾‘å‘¨å›´ä½¿ç”¨ try-catch å—
</Accordion>

## ä¸‹ä¸€æ­¥

<CardGroup cols={2}>
  <Card title="æ’æ§½å’ŒåŒºå—ç›‘æ§" icon="cube" href="/zh/grpc/slot-and-block-monitoring">
    å­¦ä¹ ç›‘æ§ç½‘ç»œå…±è¯†å’ŒåŒºå—ç”Ÿäº§
  </Card>
  <Card title="é«˜çº§æ¨¡å¼" icon="chart-line" href="/zh/grpc/stream-pump-amm-data">
    çœŸå®æ¡ˆä¾‹ï¼šç›‘æ§ Pump AMM æ•°æ®
  </Card>
</CardGroup>
